[settings]
windows_shim_mode = "symlink"
yes = true
experimental = true
auto_install = true
exec_auto_install = true
not_found_auto_install = true
task_run_auto_install = true
lockfile = true
all_compile = false

[settings.npm]
bun = true

[settings.status]
missing_tools = "always"

[hooks]
postinstall =  '''
    mise build
'''

[tasks.test]
description = "Run Gradle tests by default; use --bruno for Bruno only or --full for all tests"
usage = '''
flag "--bruno" help="Run only Bruno API tests"
flag "--full" help="Run full test suite (Gradle + Bruno)"
'''
run = '''
    BRUNO="${usage_bruno:-false}"
    FULL="${usage_full:-false}"

    TEST_RUN_GRADLE="true"
    TEST_RUN_BRUNO="false"

    if [ "$BRUNO" = "true" ] && [ "$FULL" != "true" ]; then
      TEST_RUN_GRADLE="false"
      TEST_RUN_BRUNO="true"
    elif [ "$FULL" = "true" ]; then
      TEST_RUN_GRADLE="true"
      TEST_RUN_BRUNO="true"
    fi

    TEST_RUN_GRADLE="$TEST_RUN_GRADLE" TEST_RUN_BRUNO="$TEST_RUN_BRUNO" mise x bun -- bun run scripts/test.bun.ts
'''

[tasks.build]
run = '''
    gradle build
'''

[tasks.start]
run = '''
    mise x bun -- bun run scripts/start.bun.ts
'''

[tasks.stop]
run = '''
    mise x bun -- bun run scripts/stop.bun.ts
'''

[tasks.lint]
run = '''
    echo "Lint is not configured yet; no linters are currently run by 'mise run lint'."
'''

[tasks.format]
run = ""

[tasks.save]
run = '''
    mise x bun -- bun run scripts/save.bun.ts
'''

[tasks.install]
run = '''
    mise install
'''
